"use strict";(self.webpackChunkflappy_bird=self.webpackChunkflappy_bird||[]).push([[580],{580:($e,B,a)=>{a.r(B),a.d(B,{PlaygroundModule:()=>ye});var C=a(808),H=a(914),h=a(655),I=a(579),O=a(727),n=a(223),F=a(482),M=a(403),V=a(421),j=a(32);const _=n.GuJ,Z=Symbol("__destroy"),E=Symbol("__decoratorApplied");function A(i){return"string"==typeof i?Symbol(`__destroy__${i}`):Z}function k(i,e){i[e]||(i[e]=new I.x)}function D(i,e){i[e]&&(i[e].next(),i[e].complete(),i[e]=null)}function W(i){i instanceof O.w0&&i.unsubscribe()}function L(i,e){return function(){var t;if(i&&i.call(this),D(this,A()),e.arrayName&&function K(i){Array.isArray(i)&&i.forEach(W)}(this[e.arrayName]),e.checkProperties)for(const s in this)(null===(t=e.blackList)||void 0===t?void 0:t.includes(s))||W(this[s])}}function p(i={}){return e=>{!function N(i){return!!i[_]}(e)?function Q(i,e){i.prototype.ngOnDestroy=L(i.prototype.ngOnDestroy,e)}(e,i):function q(i,e){const t=i.\u0275pipe;t.onDestroy=L(t.onDestroy,e)}(e,i),function J(i){i.prototype[E]=!0}(e)}}function r(i,e){return t=>{const s=A(e);return"string"==typeof e?function ee(i,e,t){const s=i[e];k(i,t),i[e]=function(){s.apply(this,arguments),D(this,t),i[e]=s}}(i,e,s):k(i,s),t.pipe(function z(i){return(0,F.e)((e,t)=>{(0,V.Xf)(i).subscribe((0,M.x)(t,()=>t.complete(),j.Z)),!t.closed&&e.subscribe(t)})}(i[s]))}}var l=a(135);let c=(()=>{class i{constructor(){this.birdVerticalSpeedPixelsPerSecond$$=new l.X(450),this.birdWidthPixels$$=new l.X(34),this.birdHeightPixels$$=new l.X(24),this.flyUp$$=new I.x,this.flyUpStepPixels$$=new l.X(2*this.birdHeightPixels$$.value),this.score$$=new l.X(0),this.restart$$=new I.x,this.isPlaying$$=new l.X(!0),this.objectsSpeedPixelsPerSecond$$=new l.X(100),this.backgroundSpeedPixelsPerSecond$$=new l.X(10),this.pipesHorizontalIndentPixels$$=new l.X(175),this.pipesVerticalIndentPixels$$=new l.X(144),this.groundHeight$$=new l.X("22%"),this.birdVerticalSpeedPixelsPerSecond$=this.birdVerticalSpeedPixelsPerSecond$$.asObservable(),this.birdWidthPixels$=this.birdWidthPixels$$.asObservable(),this.birdHeightPixels$=this.birdHeightPixels$$.asObservable(),this.flyUp$=this.flyUp$$.asObservable(),this.flyUpStepPixels$=this.flyUpStepPixels$$.asObservable(),this.score$=this.score$$.asObservable(),this.restart$=this.restart$$.asObservable(),this.isPlaying$=this.isPlaying$$.asObservable(),this.objectsSpeedPixelsPerSecond$=this.objectsSpeedPixelsPerSecond$$.asObservable(),this.backgroundSpeedPixelsPerSecond$=this.backgroundSpeedPixelsPerSecond$$.asObservable(),this.pipesHorizontalIndentPixels$=this.pipesHorizontalIndentPixels$$.asObservable(),this.pipesVerticalIndentPixels$=this.pipesVerticalIndentPixels$$.asObservable(),this.groundHeight$=this.groundHeight$$.asObservable()}setBirdVerticalSpeedPixelsPerSecond({speed:t}){this.birdVerticalSpeedPixelsPerSecond$$.next(t)}setBirdWidthPixels({width:t}){this.birdWidthPixels$$.next(t)}setBirdHeightPixels({height:t}){this.birdHeightPixels$$.next(t)}flyUp(){this.flyUp$$.next()}setFlyUpStepPixels({step:t}){this.flyUpStepPixels$$.next(t)}setScore({score:t}){this.score$$.next(t)}increaseScore({score:t}){this.score$$.next(this.score$$.value+t)}restart(){this.restart$$.next(),this.nearestPipesElement=void 0,this.setScore({score:0}),this.setIsPlaying({isPlaying:!0})}setIsPlaying({isPlaying:t}){this.isPlaying$$.next(t)}setObjectsSpeedPixelsPerSecond({speed:t}){this.objectsSpeedPixelsPerSecond$$.next(t)}setBackgroundSpeedPixelsPerSecond({speed:t}){this.backgroundSpeedPixelsPerSecond$$.next(t)}setPipesHorizontalIndentPixels({indent:t}){this.pipesHorizontalIndentPixels$$.next(t)}setPipesVerticalIndentPixels({indent:t}){this.pipesVerticalIndentPixels$$.next(t)}setGroundHeight({height:t}){this.groundHeight$$.next(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=n.Yz7({token:i,factory:i.\u0275fac}),i})(),u=class{constructor(e,t){this.cdRef=e,this.playgroundStoreService=t,this.animationPlayState="paused",this.backgroundImageWidthPixels=138,this.backgroundImageHeightPixels=84}ngOnInit(){this.initListeners()}initListeners(){this.playgroundStoreService.isPlaying$.pipe(r(this)).subscribe(e=>{this.animationPlayState=e?"running":"paused",this.cdRef.detectChanges()}),this.playgroundStoreService.backgroundSpeedPixelsPerSecond$.pipe(r(this)).subscribe(e=>{this.speedPixelsPerSecond=e,this.cdRef.detectChanges()}),this.playgroundStoreService.groundHeight$.pipe(r(this)).subscribe(e=>{this.groundHeight=e,this.cdRef.detectChanges()})}};u.\u0275fac=function(e){return new(e||u)(n.Y36(n.sBO),n.Y36(c))},u.\u0275cmp=n.Xpm({type:u,selectors:[["fb-background"]],hostVars:10,hostBindings:function(e,t){2&e&&n.Udp("--speed-pixels-per-second",t.speedPixelsPerSecond)("--ground-height",t.groundHeight)("--animation-play-state",t.animationPlayState)("--background-image-width-pixels",t.backgroundImageWidthPixels)("--background-image-height-pixels",t.backgroundImageHeightPixels)},decls:0,vars:0,template:function(e,t){},styles:['[_nghost-%COMP%]{position:absolute;top:0;left:0;display:block;width:100%;height:100%;overflow:hidden;background-color:var(--sky-color)}[_nghost-%COMP%]:before{position:absolute;top:calc(100% - var(--ground-height));left:0;width:100%;height:var(--ground-height);content:"";background-color:var(--grass-color)}[_nghost-%COMP%]:after{position:absolute;bottom:var(--ground-height);left:0;width:200%;height:calc(var(--background-image-height-pixels) * 1px);content:"";background-image:url(background-day.7de6de9a13b844ef.png);background-repeat:repeat-x;animation-name:background-image-move-left;animation-duration:calc(var(--background-image-width-pixels) * 1s / var(--speed-pixels-per-second));animation-play-state:var(--animation-play-state);animation-timing-function:linear;animation-iteration-count:infinite}@keyframes background-image-move-left{to{transform:translate(calc(var(--background-image-width-pixels) * -1px))}}'],changeDetection:0}),u=(0,h.gn)([p()],u);var te=a(306);class ie extends O.w0{constructor(e,t){super()}schedule(e,t=0){return this}}const w={setInterval(i,e,...t){const{delegate:s}=w;return(null==s?void 0:s.setInterval)?s.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){const{delegate:e}=w;return((null==e?void 0:e.clearInterval)||clearInterval)(i)},delegate:void 0};var ne=a(737);const Y={now:()=>(Y.delegate||Date).now(),delegate:void 0};class x{constructor(e,t=x.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,s){return new this.schedulerActionCtor(this,e).schedule(s,t)}}x.now=Y.now;const G=new class re extends x{constructor(e,t=x.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let s;this._active=!0;do{if(s=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,s){for(;e=t.shift();)e.unsubscribe();throw s}}}(class se extends ie{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const s=this.id,o=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(o,s,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,s=0){return w.setInterval(e.flush.bind(e,this),s)}recycleAsyncId(e,t,s=0){if(null!=s&&this.delay===s&&!1===this.pending)return t;w.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const s=this._execute(e,t);if(s)return s;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let o,s=!1;try{this.work(e)}catch(d){s=!0,o=d||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:s}=t;this.work=this.state=this.scheduler=null,this.pending=!1,(0,ne.P)(s,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}),oe=G;var ae=a(532);function T(i=0,e,t=oe){let s=-1;return null!=e&&((0,ae.K)(e)?t=e:s=e),new te.y(o=>{let d=function le(i){return i instanceof Date&&!isNaN(i)}(i)?+i-t.now():i;d<0&&(d=0);let $=0;return t.schedule(function(){o.closed||(o.next($++),0<=s?this.schedule(void 0,s):o.complete())},d)})}var g=a(777);const de=[(0,g.oB)({transform:"*"}),(0,g.jt)("{{ duration }} {{ timing }}",(0,g.oB)({transform:"translateX({{ to }})"}))],ce=[(0,g.oB)({transform:"*"}),(0,g.jt)("{{ duration }} {{ timing }}",(0,g.oB)({transform:"translateY({{ to }})"}))];let he=(()=>{class i{constructor(t){this.animationBuilder=t}translateXAnimation(){return this.animationBuilder.build(de)}translateYAnimation(){return this.animationBuilder.build(ce)}}return i.\u0275fac=function(t){return new(t||i)(n.LFG(g._j))},i.\u0275prov=n.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const U=new n.OlP("An abstraction over global window object",{factory:()=>{const{defaultView:i}=(0,n.f3M)(C.K0);if(!i)throw new Error("Window is not available");return i}}),pe=new n.OlP("An abstraction over window.navigator object",{factory:()=>(0,n.f3M)(U).navigator});var ue=a(313);let ge=(()=>{class i{constructor(t,s,o,d,$){this.document=t,this.navigator=s,this.window=o,this.domSanitizer=d,this.rendererFactory=$,this.renderer=this.rendererFactory.createRenderer(null,null)}get body(){return this.document.body}}return i.\u0275fac=function(t){return new(t||i)(n.LFG(C.K0),n.LFG(pe),n.LFG(U),n.LFG(ue.H7),n.LFG(n.FYo))},i.\u0275prov=n.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),f=class{constructor(e,t,s,o){this.elementRef=e,this.cdRef=t,this.domService=s,this.playgroundStoreService=o,this.isPlaying=!1,this.playgroundStoreService.birdElement=this.elementRef.nativeElement}ngOnInit(){this.initListeners(),this.initPosition()}get parentHeightPixels(){var e,t;return+((null===(t=null===(e=this.elementRef.nativeElement.parentElement)||void 0===e?void 0:e.clientHeight)||void 0===t?void 0:t.toFixed())||0)}get birdTopPixels(){return+this.elementRef.nativeElement.getBoundingClientRect().top.toFixed()}initListeners(){this.playgroundStoreService.restart$.pipe(r(this)).subscribe(()=>{this.initPosition()}),this.playgroundStoreService.groundHeight$.pipe(r(this)).subscribe(()=>{this.maxTopPixels=+(.78*this.parentHeightPixels).toFixed(),this.cdRef.detectChanges()}),this.playgroundStoreService.birdWidthPixels$.pipe(r(this)).subscribe(e=>{this.birdWidthPixels=e,this.cdRef.detectChanges()}),this.playgroundStoreService.birdHeightPixels$.pipe(r(this)).subscribe(e=>{this.birdHeightPixels=e,this.cdRef.detectChanges()}),this.playgroundStoreService.flyUpStepPixels$.pipe(r(this)).subscribe(e=>{this.flyUpStepPixels=e,this.cdRef.detectChanges()}),this.playgroundStoreService.birdVerticalSpeedPixelsPerSecond$.pipe(r(this)).subscribe(e=>{this.verticalSpeedPixelsPerSecond=e,this.cdRef.detectChanges()}),this.playgroundStoreService.isPlaying$.pipe(r(this)).subscribe(e=>{this.isPlaying=e,this.animationPlayState=this.isPlaying?"running":"paused",this.cdRef.detectChanges()}),this.playgroundStoreService.flyUp$.pipe(r(this)).subscribe(()=>this.flyUp())}flyUp(){var e;if(!this.isPlaying)return;null===(e=this.flyDownTimerSub)||void 0===e||e.unsubscribe();const t=this.birdTopPixels-this.flyUpStepPixels,s=+(this.flyUpStepPixels/this.verticalSpeedPixelsPerSecond).toFixed(2);this.setTranslateYAnimation({duration:`${s}s`,timing:"ease-out",to:`${t}px`}),this.flyDownTimerSub=T(1e3*s).pipe(r(this)).subscribe(()=>this.flyDown())}flyDown(){const e=this.maxTopPixels,t=((e-this.birdTopPixels)/this.verticalSpeedPixelsPerSecond).toFixed(2);this.setTranslateYAnimation({duration:`${t}s`,timing:"ease-in",to:`${e}px`})}setTranslateYAnimation({duration:e,timing:t,to:s}){this.domService.renderer.setStyle(this.elementRef.nativeElement,"transition",`transform ${e} ${t}`),this.domService.renderer.setStyle(this.elementRef.nativeElement,"transform",`translateY(${s})`)}initPosition(){!this.birdHeightPixels||this.setTranslateYAnimation({duration:"0s",timing:"linear",to:this.parentHeightPixels/2-this.birdHeightPixels/2+"px"})}};f.\u0275fac=function(e){return new(e||f)(n.Y36(n.SBq),n.Y36(n.sBO),n.Y36(ge),n.Y36(c))},f.\u0275cmp=n.Xpm({type:f,selectors:[["fb-bird"]],hostVars:6,hostBindings:function(e,t){2&e&&n.Udp("--animation-play-state",t.animationPlayState)("--bird-width-pixels",t.birdWidthPixels)("--bird-height-pixels",t.birdHeightPixels)},decls:0,vars:0,template:function(e,t){},styles:['[_nghost-%COMP%]{position:absolute;left:calc(50% - var(--bird-width-pixels) * 1px / 2);display:block;width:calc(var(--bird-width-pixels) * 1px);height:calc(var(--bird-height-pixels) * 1px);overflow:hidden}[_nghost-%COMP%]:after{display:block;width:100%;height:100%;content:"";background-repeat:no-repeat;background-size:cover;animation:bird-wings .3s var(--animation-play-state) linear infinite}@keyframes bird-wings{0%,to{background-image:url(bluebird-downflap.abaede979b5a439f.png)}25%,75%{background-image:url(bluebird-midflap.57de81b201d11e92.png)}50%{background-image:url(bluebird-upflap.483f06d6baf6d911.png)}}'],changeDetection:0}),f=(0,h.gn)([p()],f);let m=class{constructor(e,t,s){this.elementRef=e,this.cdRef=t,this.playgroundStoreService=s,this.height="0",this.speedPixelsPerSecond=0,this.animationPlayState="paused",this.groundImageWidthPixels=24,this.groundImageHeightPixels=22,this.playgroundStoreService.groundElement=this.elementRef.nativeElement}ngOnInit(){this.initListeners()}initListeners(){this.playgroundStoreService.isPlaying$.pipe(r(this)).subscribe(e=>{this.animationPlayState=e?"running":"paused",this.cdRef.detectChanges()}),this.playgroundStoreService.objectsSpeedPixelsPerSecond$.pipe(r(this)).subscribe(e=>{this.speedPixelsPerSecond=e,this.cdRef.detectChanges()}),this.playgroundStoreService.groundHeight$.pipe(r(this)).subscribe(e=>{this.height=e,this.cdRef.detectChanges()})}};m.\u0275fac=function(e){return new(e||m)(n.Y36(n.SBq),n.Y36(n.sBO),n.Y36(c))},m.\u0275cmp=n.Xpm({type:m,selectors:[["fb-ground"]],hostVars:10,hostBindings:function(e,t){2&e&&n.Udp("--height",t.height)("--speed-pixels-per-second",t.speedPixelsPerSecond)("--animation-play-state",t.animationPlayState)("--ground-image-width-pixels",t.groundImageWidthPixels)("--ground-image-height-pixels",t.groundImageHeightPixels)},decls:0,vars:0,template:function(e,t){},styles:['[_nghost-%COMP%]{position:absolute;bottom:0;left:0;display:block;width:100%;height:var(--height);overflow:hidden;background-color:var(--ground-color)}[_nghost-%COMP%]:before{position:absolute;top:0;left:0;width:200%;height:calc(var(--ground-image-height-pixels) * 1px);content:"";background-image:url(ground-green.ff2a1a74b7074713.png);background-repeat:repeat-x;animation-name:ground-image-move-left;animation-duration:calc(var(--ground-image-width-pixels) * 1s / var(--speed-pixels-per-second));animation-play-state:var(--animation-play-state);animation-timing-function:linear;animation-iteration-count:infinite}@keyframes ground-image-move-left{to{transform:translate(calc(var(--ground-image-width-pixels) * -1px))}}'],changeDetection:0}),m=(0,h.gn)([p()],m);var P=(()=>{return(i=P||(P={}))[i.BirdCollideWithGround=10]="BirdCollideWithGround",i[i.BirdCollideWithPipe=10]="BirdCollideWithPipe",i[i.NearestPipesSetter=100]="NearestPipesSetter",i[i.PipesGenerator=100]="PipesGenerator",P;var i})();function R(i=0,e=G){return i<0&&(i=0),T(i,i,e)}let b=class{constructor(e,t,s,o){this.elementRef=e,this.cdRef=t,this.playgroundStoreService=s,this.animationService=o,this.pipeHeadWidthPixels=52,this.pipeHeadHeightPixels=24,this.isPlaying=!1}ngOnInit(){this.initListeners()}get parentWidthPixels(){var e;return(null===(e=this.elementRef.nativeElement.parentElement)||void 0===e?void 0:e.clientWidth)||0}initPipesHeights({pipesVerticalIndentPixels:e}){const t=Math.ceil(e/this.elementRef.nativeElement.clientHeight*100),s=function fe(i,e){const t=Math.ceil(i),s=Math.floor(e);return Math.floor(Math.random()*(s-t+1))+t}(10,70),o=100-s-t;this.topPipeHeight=`${s}%`,this.bottomPipeHeight=`${o}%`}initListeners(){this.playgroundStoreService.restart$.pipe(r(this)).subscribe(()=>{this.elementRef.nativeElement.remove()}),this.playgroundStoreService.pipesVerticalIndentPixels$.pipe(r(this)).subscribe(e=>{this.initPipesHeights({pipesVerticalIndentPixels:e}),this.cdRef.detectChanges()}),this.playgroundStoreService.isPlaying$.pipe(r(this)).subscribe(e=>{this.isPlaying=e,this.toggleAnimationState({isPlaying:e}),this.cdRef.detectChanges()}),this.playgroundStoreService.objectsSpeedPixelsPerSecond$.pipe(r(this)).subscribe(e=>{this.setTranslateXAnimation({speedPixelsPerSecond:e}),this.toggleAnimationState({isPlaying:this.isPlaying}),this.cdRef.detectChanges()})}setTranslateXAnimation({speedPixelsPerSecond:e}){var t;null===(t=this.translateXAnimation)||void 0===t||t.destroy();const o={duration:(this.parentWidthPixels+2*this.pipeHeadWidthPixels)/e+"s",timing:"linear",to:`-${this.parentWidthPixels+this.pipeHeadWidthPixels}px`};this.translateXAnimation=this.animationService.translateXAnimation().create(this.elementRef.nativeElement,{params:o}),this.translateXAnimation.onDone(()=>{this.elementRef.nativeElement.remove()})}toggleAnimationState({isPlaying:e}){var t,s;e?null===(t=this.translateXAnimation)||void 0===t||t.play():null===(s=this.translateXAnimation)||void 0===s||s.pause()}};b.\u0275fac=function(e){return new(e||b)(n.Y36(n.SBq),n.Y36(n.sBO),n.Y36(c),n.Y36(he))},b.\u0275cmp=n.Xpm({type:b,selectors:[["fb-pipes"]],hostVars:8,hostBindings:function(e,t){2&e&&n.Udp("--top-pipe-height",t.topPipeHeight)("--bottom-pipe-height",t.bottomPipeHeight)("--pipe-head-width-pixels",t.pipeHeadWidthPixels)("--pipe-head-height-pixels",t.pipeHeadHeightPixels)},decls:6,vars:0,consts:[[1,"pipe"],[1,"pipe__head"],[1,"pipe__body"]],template:function(e,t){1&e&&(n.TgZ(0,"div",0),n._UZ(1,"div",1)(2,"div",2),n.qZA(),n.TgZ(3,"div",0),n._UZ(4,"div",1)(5,"div",2),n.qZA())},styles:["[_nghost-%COMP%]{position:absolute;top:0;left:100%;display:block;width:calc(var(--pipe-head-width-pixels) * 1px);height:100%;overflow:hidden}.pipe[_ngcontent-%COMP%]{position:absolute;display:flex;flex-direction:column;align-items:center;width:100%}.pipe__head[_ngcontent-%COMP%]{width:100%;height:calc(var(--pipe-head-height-pixels) * 1px);background-image:url(pipe-head-green.b1cc28d21ece30fa.png);background-size:contain}.pipe__body[_ngcontent-%COMP%]{width:calc(100% - 4px);height:calc(100% - var(--pipe-head-height-pixels) * 1px);background-image:url(pipe-body-green.54b82a39cadeefdd.png);background-size:contain}.pipe[_ngcontent-%COMP%]:first-child{top:0;height:var(--top-pipe-height);transform:rotateX(180deg)}.pipe[_ngcontent-%COMP%]:last-child{bottom:0;height:var(--bottom-pipe-height)}"],changeDetection:0}),b=(0,h.gn)([p()],b);const me=["pipesContainerRef"];let v=class{constructor(e,t,s){this.elementRef=e,this.cdRef=t,this.playgroundStoreService=s,this.isPlaying=!1,this.playgroundStoreService.obstaclesElement=this.elementRef.nativeElement}get hostWidthPx(){return this.elementRef.nativeElement.clientWidth}ngOnInit(){this.initListeners()}initListeners(){this.playgroundStoreService.birdWidthPixels$.pipe(r(this)).subscribe(e=>{this.birdWidthPixels=e,this.cdRef.detectChanges()}),this.playgroundStoreService.pipesHorizontalIndentPixels$.pipe(r(this)).subscribe(e=>{this.pipesHorizontalIndentPixels=e,this.cdRef.detectChanges()}),this.playgroundStoreService.groundHeight$.pipe(r(this)).subscribe(e=>{this.groundHeight=e,this.cdRef.detectChanges()}),this.playgroundStoreService.isPlaying$.pipe(r(this)).subscribe(e=>{this.isPlaying=e,this.cdRef.detectChanges()}),this.runNearestPipesSetter(),this.runPipesGenerator()}runNearestPipesSetter(){R(P.NearestPipesSetter).pipe(r(this)).subscribe(()=>{if(!this.isPlaying)return;if(!this.playgroundStoreService.nearestPipesElement)return void(this.playgroundStoreService.nearestPipesElement=this.elementRef.nativeElement.firstElementChild);const e=this.playgroundStoreService.nearestPipesElement.getBoundingClientRect();(this.hostWidthPx/2-this.birdWidthPixels/2>e.right||!this.playgroundStoreService.nearestPipesElement)&&(this.playgroundStoreService.nearestPipesElement=this.playgroundStoreService.nearestPipesElement.nextElementSibling,this.playgroundStoreService.increaseScore({score:1}))})}runPipesGenerator(){R(P.PipesGenerator).pipe(r(this)).subscribe(()=>{if(!this.isPlaying)return;if(!this.lastPipesComponentRef)return void this.generatePipesCouple();const e=this.lastPipesComponentRef.instance.elementRef.nativeElement;this.hostWidthPx-e.getBoundingClientRect().right+e.clientWidth>=this.pipesHorizontalIndentPixels&&this.generatePipesCouple()})}generatePipesCouple(){this.lastPipesComponentRef=this.pipesContainerRef.createComponent(b),this.cdRef.detectChanges()}};function Pe(i,e){1&i&&n._UZ(0,"img",1),2&i&&n.MGl("src","assets/images/png/numbers/",e.$implicit,".png",n.LSH)}v.\u0275fac=function(e){return new(e||v)(n.Y36(n.SBq),n.Y36(n.sBO),n.Y36(c))},v.\u0275cmp=n.Xpm({type:v,selectors:[["fb-obstacles"]],viewQuery:function(e,t){if(1&e&&n.Gf(me,7,n.s_b),2&e){let s;n.iGM(s=n.CRH())&&(t.pipesContainerRef=s.first)}},hostVars:4,hostBindings:function(e,t){2&e&&n.Udp("--ground-height",t.groundHeight)("--host-width-px",t.hostWidthPx)},decls:2,vars:0,consts:[["pipesContainerRef",""]],template:function(e,t){1&e&&n.GkF(0,null,0)},styles:["[_nghost-%COMP%]{position:absolute;top:0;left:0;display:block;width:100%;height:calc(100% - var(--ground-height));overflow:hidden}"],changeDetection:0}),v=(0,h.gn)([p()],v);let y=class{constructor(e,t){this.cdRef=e,this.playgroundStoreService=t,this.score=0}ngOnInit(){this.initListeners()}initListeners(){this.playgroundStoreService.score$.pipe(r(this)).subscribe(e=>{this.score=e,this.cdRef.detectChanges()})}};y.\u0275fac=function(e){return new(e||y)(n.Y36(n.sBO),n.Y36(c))},y.\u0275cmp=n.Xpm({type:y,selectors:[["fb-score"]],decls:1,vars:1,consts:[[3,"src",4,"ngFor","ngForOf"],[3,"src"]],template:function(e,t){1&e&&n.YNc(0,Pe,1,1,"img",0),2&e&&n.Q6J("ngForOf",t.score.toString().split(""))},directives:[C.sg],styles:["[_nghost-%COMP%]{position:absolute;top:10%;left:50%;display:block;font-size:3rem;font-weight:700;color:var(--text-primary-color);transform:translate(-50%)}"],changeDetection:0}),y=(0,h.gn)([p()],y);let S=class{constructor(e,t){this.cdRef=e,this.playgroundStoreService=t,this.isPlaying=!1}ngOnInit(){this.initListeners()}flyUp(){this.isPlaying?this.playgroundStoreService.flyUp():this.playgroundStoreService.restart()}initListeners(){this.playgroundStoreService.isPlaying$.subscribe(e=>{this.isPlaying=e,this.isPlaying?(this.runGroundCollisionListener(),this.runPipesCollisionListener()):(this.destroyGroundCollisionListener(),this.destroyPipesCollisionListener())})}runGroundCollisionListener(){this.destroyGroundCollisionListener(),this.groundCollisionListenerSub=R(P.BirdCollideWithGround).pipe(r(this)).subscribe(()=>{if(!this.playgroundStoreService.groundElement||!this.playgroundStoreService.birdElement)return;const e=this.playgroundStoreService.birdElement.getBoundingClientRect(),t=this.playgroundStoreService.groundElement.getBoundingClientRect();e.bottom>=t.top&&(this.playgroundStoreService.setIsPlaying({isPlaying:!1}),this.cdRef.markForCheck())})}destroyGroundCollisionListener(){var e;null===(e=this.groundCollisionListenerSub)||void 0===e||e.unsubscribe()}runPipesCollisionListener(){this.destroyPipesCollisionListener(),this.pipesCollisionListenerSub=R(P.BirdCollideWithPipe).pipe(r(this)).subscribe(()=>{var e,t;if(!(null===(e=this.playgroundStoreService.nearestPipesElement)||void 0===e?void 0:e.firstElementChild)||!(null===(t=this.playgroundStoreService.nearestPipesElement)||void 0===t?void 0:t.lastElementChild)||!this.playgroundStoreService.birdElement)return;const s=this.playgroundStoreService.birdElement.getBoundingClientRect(),o=this.playgroundStoreService.nearestPipesElement.getBoundingClientRect(),d=this.playgroundStoreService.nearestPipesElement.firstElementChild.getBoundingClientRect(),$=this.playgroundStoreService.nearestPipesElement.lastElementChild.getBoundingClientRect(),X=s.right>=o.left&&s.right<=o.right||s.left>=o.left&&s.left<=o.right;(X&&s.top<=d.bottom||X&&s.bottom>=$.top)&&(this.playgroundStoreService.setIsPlaying({isPlaying:!1}),this.cdRef.detectChanges())})}destroyPipesCollisionListener(){var e;null===(e=this.pipesCollisionListenerSub)||void 0===e||e.unsubscribe()}};S.\u0275fac=function(e){return new(e||S)(n.Y36(n.sBO),n.Y36(c))},S.\u0275cmp=n.Xpm({type:S,selectors:[["fb-playground"]],hostBindings:function(e,t){1&e&&n.NdJ("click",function(){return t.flyUp()})},decls:5,vars:0,template:function(e,t){1&e&&n._UZ(0,"fb-background")(1,"fb-obstacles")(2,"fb-ground")(3,"fb-score")(4,"fb-bird")},directives:[u,v,m,y,f],styles:["[_nghost-%COMP%]{position:relative;display:block;width:100%;height:100%;overflow:hidden}"],changeDetection:0}),S=(0,h.gn)([p()],S);const be=[{path:"",component:S}];let ve=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[[H.Bz.forChild(be)],H.Bz]}),i})(),ye=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({providers:[c],imports:[[C.ez,ve]]}),i})()}}]);